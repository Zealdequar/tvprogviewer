function globalSearchProgramme(n){n.length!=0&&n!=""&&n!=null&&(incSearch==1?($("#TvProgrammeGlobalSearchGrid").jqGrid({url:"Catalog/GlobalSearchProgramme?progType=1&findTitle="+n+"&category="+$("#userCategory option:selected").val().split(";")[1]+"&genres="+GetGenres(".btn-genre-search.active")+"&channels="+(chansArr?chansArr.map(n=>n.ChannelId).join(";"):""),datatype:"json",type:"GET",colNames:["Рейтинг","Название рейтинга","Жанр","Название жанра","Анонс","Эмблема канала","Название канала","День","От","До","Передачи",""],colModel:[{key:!1,name:"RatingContent",index:"RatingContent",sortable:!0,width:40,align:"center",formatter:imgRating,cellattr:function(n,t,i){return'title="'+i.RatingName+'"'}},{key:!1,name:"RatingName",index:"RatingName",sortable:!0,widht:"0",align:"center"},{key:!1,name:"GenreContent",index:"GenreContent",sortable:!0,width:"46px",align:"center",formatter:imgGenre,cellattr:function(n,t,i){return'title="'+i.GenreName+'"'}},{key:!1,name:"GenreName",index:"GenreName",sortable:!0,width:"0",align:"center"},{key:!1,name:"AnonsContent",index:"AnonsContent",sortable:!0,width:"43px",align:"center",formatter:imgAnons},{key:!1,name:"ChannelContent",index:"ChannelContent",sortable:!0,align:"center",formatter:imgChannel},{key:!1,name:"ChannelName",index:"ChannelName",sortable:!0},{key:!1,name:"DayMonth",index:"DayMonth",sortable:!0,align:"center",width:100},{key:!1,name:"Start",index:"Start",sortable:!0,align:"center",width:55,sorttype:"datetime",formatter:"date",formatoptions:{srcformat:"ISO8601Long",newformat:"H:i"}},{key:!1,name:"Stop",index:"Stop",sortable:!0,align:"center",width:55,sorttype:"datetime",formatter:"date",formatoptions:{srcformat:"ISO8601Long",newformat:"H:i"}},{key:!1,name:"TelecastTitle",index:"TelecastTitle",sortable:!0,width:556},{key:!1,name:"TelecastDescr",index:"TelecastDescr",hidden:!0}],rowNum:20,beforeSelectRow:function(){return $("#TvProgrammeGlobalSearchGrid").jqGrid("resetSelection"),!0},loadComplete:function(){$(this).find("tr.jqgrow:odd").addClass("alt-green-background");$("tr.jqgrow td input","#TvProgrammeGlobalSearchGrid").on("click",function(){$(this).closest("tr").find("td:nth-child(6)").find("img").length?($("#mainToolbarSearch").show(50),$("#anonsToolbarSearch").show(50),$("#anonsDescrGlobalSearch").html($(this).closest("tr").find("td:nth-child(13)").attr("title"))):($("#mainToolbarSearch").hide(50),$("#anonsToolbarSearch").hide(50),$("#anonsDescrGlobalSearch").hide(150))})},rowList:[10,20,30,40,50,100,500,1e3],height:"auto",width:null,autowidth:!0,shrinkToFit:!0,viewrecords:!0,caption:"Список найденных передач из эфирной сетки | Телепередачи, которые вы ищете | Результаты поиска по программе передач",emptyrecords:"Программа передач не обнаружена",pager:"#TvProgrammeGlobalSearchPager",loadonce:!1,forceClientSorting:!0,multiselect:!0,gridview:!0,rowattr:function(n){return getRowClassBySearches(n.Stop)}}).navGrid("#TvProgrammeGlobalSearchPager",{edit:!1,add:!1,del:!1,search:!1,searchtext:"Поиск передачи",refresh:!0},{zIndex:100,caption:"Поиск передачи",sopt:["cn"]}),$("#TvProgrammeGlobalSearchGrid").jqGrid("hideCol","GenreName"),$("#TvProgrammeGlobalSearchGrid").jqGrid("hideCol","RatingName"),$("#TvProgrammeGlobalSearchGrid").jqGrid("hideCol","RatingContent"),$("#TvProgrammeGlobalSearchGrid").jqGrid("setGridWidth",$("#mwSearch").width()),$("#TvProgrammeGlobalSearchGrid").jqGrid("setGridHeight",548)):($("#TvProgrammeGlobalSearchGrid").setGridParam({url:"Catalog/GlobalSearchProgramme?progType=1&findTitle="+n+"&category="+$("#userCategory option:selected").val().split(";")[1]+"&genres="+GetGenres(".btn-genre-search.active")+"&channels="+(chansArr?chansArr.map(n=>n.ChannelId).join(";"):"")}),$("#TvProgrammeGlobalSearchGrid").trigger("reloadGrid")),incSearch++,$(".drag-tool-genre").width($("#mwSearch").width()),window.setTimeout(function(){$("#genresToolbarSearch").show()},3e3))}function fillGenresToolbarSearch(){$("#genresToolbarSearch").hide();$.ajax({url:"Catalog/GetGenres",dataType:"json","async":!1,type:"Get",contentType:"application/json; charset=utf-8",success:function(n){var t,i;for($("#genresToolbarSearch").empty(),t=0;t<n.length;t++)i=$('<button id="'+n[t].GenreId+'" class="btn btn-default btn-genre-global-search">'),$("#genresToolbarSearch").append(i.html('<img src="'+n[t].GenrePath+'" title="'+n[t].GenreName+'" alt="'+n[t].GenreName+'" height="24px" width="24px">'));$(".btn-group-genres-global-search").on("click",".btn",function(n){n.preventDefault();$(this).toggleClass("active");$("#TvProgrammeGlobalSearchGrid").setGridParam({url:"Catalog/GlobalSearchProgramme?progType=1&findTitle="+$(".search-text").val()+"&category="+$("#userCategory option:selected").val().split(";")[1]+"&genres="+GetGenres(".btn-genre-global-search.active")+"&channels="+(chansArr?chansArr.map(n=>n.ChannelId).join(";"):"")});$("#TvProgrammeGlobalSearchGrid").trigger("reloadGrid")})},error:function(n,t){var i=n.status===0?"Not connect.\n Verify Network.":n.status==404?"Requested page not found. [404]":n.status==500?"Internal Server Error [500].":t==="parsererror"?"Requested JSON parse failed.":t==="timeout"?"Time out error.":t==="abort"?"Ajax request aborted.":"Uncaught Error.\n"+n.responseText}})}var incSearch=1;let chansArr=[];$(function(){$.jgrid.no_legacy_api=!0;$.jgrid.useJSON=!0;chansArr=getStorageChannels();fillGenresToolbarSearch();$("#anonsToolbarSearch").on("click",function(){$("#anonsDescrGlobalSearch").toggle(100)});$(".search-button").on("click",function(){globalSearchProgramme($(".search-text").val())});$("#dragToolbarGenreSearch").draggable()});